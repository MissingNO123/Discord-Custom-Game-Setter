<!doctype HTML>
<html>
    <head>
        <title>Discord Custom Game Setter</title>
        <script src="discordio.js"></script> <!-- The discord.io client file -->
    </head>
    <body style="font-family:Arial,sans-serif;">
			<form id="frm1">
				Token: <input type="text" name="token" id="token" size="90" value=""><br />
				Game: <input type="text" name="game" id="game" size="90" value=""><br />
			</form> 
			<button onclick="setUserGameInfoFromPageThingFunction()">Submit</button>
			<button onclick="howToToken()">How do I get my token?</button><br />
			<span style="color:red;">WARNING! Tokens should be handled with care (treat them as if they were your password!), as they grant access to your user account. I am not responsible for any damage caused to you or your account by using this tool, 
				use it at your own risk.</span>
	    		<br /> (If nothing happens when you hit submit, you may have entered an invalid token.)
	    		<br /> <br />	 
			
			<div style="background-color:#222222;padding:12px;">
				<span id="alltext" style="font-family:Monaco,monospace;color:#FEFEFE;"><b>Log</b><br/><br/></span>
	    		</div> 
			
        <script>
if (typeof(Storage) !== "undefined") {
    if (localStorage.getItem("token") == undefined) {
	    localStorage.setItem("token", "");
    } else {
    	document.getElementById("token").value = localStorage.getItem("token");
    }
} else {
    //no storage 4 u
    
}
		
function setUserGameInfoFromPageThingFunction() {
	
	var x = document.getElementById("frm1");
	var tokenFromPage = x.elements[0].value;
	localStorage.setItem("token", tokenFromPage);
	var gameFromPage = x.elements[1].value;
	var client = new Discord.Client({
		token: tokenFromPage,
		autorun: true
	});

	var presence = {
		idle_since: null,
		game: {
			name: gameFromPage,
			type: 0,
			url: null
		}
	};

	client.on("ready", function(event) {
		addText("Connected!");
		addText("Logged in as: ");
		addText(client.username + " - (" + client.id + ")");
		client.setPresence(presence); addText("Game set to \"" + presence.game.name + "\"");
		addText("All done! You can close the page now.<br />");
	});
}

function addText(add) {
	document.getElementById("alltext").innerHTML += add + "<br />";	
	console.log(add);
}

function howToToken() {
	alert("To get your token: \nOpen Discord in your web browser, press F12, click console. \nType \"console.log(localStorage.token)\", it will print your token in quotation marks. \nIt will look something like this: \"MTc1DeF2GHIjKLm3NOP4QRS5.Tuv6WX.y7Z_ABcDE7-fgHij8K8LMNopQrs\"");
}
      </script>
    </body>
</html>
